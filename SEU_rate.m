
spenvisdata = [  1.0000E-01,  1.3154E+07,  5.6388E+04
  3.0000E-01,  1.3140E+07,  7.8458E+04
  5.0000E-01,  1.3123E+07,  9.7888E+04
  7.0000E-01,  1.3101E+07,  1.1620E+05
  1.0000E+00,  1.3063E+07,  1.4221E+05
  1.1000E+00,  1.3048E+07,  1.4997E+05
  1.2000E+00,  1.3032E+07,  1.5867E+05
  1.4000E+00,  1.2999E+07,  1.7365E+05
  1.6000E+00,  1.2963E+07,  1.8854E+05
  1.8000E+00,  1.2924E+07,  2.0250E+05
  2.0000E+00,  1.2882E+07,  2.1890E+05
  2.2000E+00,  1.2837E+07,  2.3106E+05
  2.5000E+00,  1.2764E+07,  2.5247E+05
  2.8000E+00,  1.2686E+07,  2.6999E+05
  3.2000E+00,  1.2573E+07,  2.9240E+05
  3.5000E+00,  1.2483E+07,  3.0750E+05
  4.0000E+00,  1.2322E+07,  3.3784E+05
  4.5000E+00,  1.2149E+07,  3.5463E+05
  5.0000E+00,  1.1967E+07,  3.7465E+05
  5.5000E+00,  1.1776E+07,  3.8863E+05
  6.3000E+00,  1.1456E+07,  4.1070E+05
  7.1000E+00,  1.1121E+07,  4.2693E+05
  8.0000E+00,  1.0732E+07,  4.3752E+05
  9.0000E+00,  1.0296E+07,  4.3539E+05
  1.0000E+01,  9.8593E+06,  4.3714E+05
  1.1000E+01,  9.4292E+06,  4.2305E+05
  1.2000E+01,  9.0084E+06,  4.1868E+05
  1.4000E+01,  8.2017E+06,  3.8801E+05
  1.6000E+01,  7.4622E+06,  3.5151E+05
  1.8000E+01,  6.8001E+06,  3.1058E+05
  2.0000E+01,  6.1997E+06,  2.8978E+05
  2.2000E+01,  5.6534E+06,  2.5653E+05
  2.5000E+01,  4.9378E+06,  2.2058E+05
  2.8000E+01,  4.3221E+06,  1.8988E+05
  3.2000E+01,  3.6408E+06,  1.5074E+05
  3.5000E+01,  3.2286E+06,  1.2410E+05
  4.0000E+01,  2.6640E+06,  1.0174E+05
  4.5000E+01,  2.2165E+06,  7.7255E+04
  5.0000E+01,  1.8653E+06,  6.3228E+04
  5.5000E+01,  1.5831E+06,  4.9641E+04
  6.3000E+01,  1.2399E+06,  3.6163E+04
  7.1000E+01,  9.8773E+05,  2.6879E+04
  8.0000E+01,  7.7780E+05,  1.9771E+04
  9.0000E+01,  6.0842E+05,  1.4107E+04
  1.0000E+02,  4.8530E+05,  1.0516E+04
  1.1000E+02,  3.9365E+05,  7.8147E+03
  1.2000E+02,  3.2441E+05,  6.0329E+03
  1.4000E+02,  2.2683E+05,  3.7244E+03
  1.6000E+02,  1.6483E+05,  2.4760E+03
  1.8000E+02,  1.2297E+05,  1.7106E+03
  2.0000E+02,  9.3519E+04,  1.2341E+03
  2.2000E+02,  7.2257E+04,  8.9204E+02
  2.5000E+02,  5.0190E+04,  5.7912E+02
  2.8000E+02,  3.5598E+04,  3.9366E+02
  3.2000E+02,  2.2758E+04,  2.4834E+02
  3.5000E+02,  1.6319E+04,  1.8092E+02
  4.0000E+02,  8.9670E+03,  1.1316E+02
  4.5000E+02,  4.3228E+03,  7.2605E+01
  5.0000E+02,  2.4653E+03,  1.6962E+00
  5.5000E+02,  2.3823E+03,  1.6245E+00
  6.3000E+02,  2.2568E+03,  1.5109E+00
  7.1000E+02,  2.1403E+03,  1.4023E+00
  8.0000E+02,  2.0192E+03,  1.2888E+00
  9.0000E+02,  1.8961E+03,  1.1741E+00
  1.0000E+03,  1.7838E+03,  1.0714E+00
  1.1000E+03,  1.6812E+03,  9.7954E-01
  1.2000E+03,  1.5874E+03,  8.9749E-01
  1.4000E+03,  1.4218E+03,  7.5825E-01
  1.6000E+03,  1.2814E+03,  6.4605E-01
  1.8000E+03,  1.1613E+03,  5.5479E-01
  2.0000E+03,  1.0578E+03,  4.7992E-01
  2.2000E+03,  9.6804E+02,  4.1796E-01
  2.5000E+03,  8.5380E+02,  3.4363E-01
  2.8000E+03,  7.5935E+02,  2.8603E-01
  3.2000E+03,  6.5658E+02,  2.2781E-01
  3.5000E+03,  5.9327E+02,  1.9424E-01
  4.0000E+03,  5.0679E+02,  1.5171E-01
  4.5000E+03,  4.3864E+02,  1.2089E-01
  5.0000E+03,  3.8392E+02,  9.8002E-02
  5.5000E+03,  3.3926E+02,  8.0632E-02
  6.3000E+03,  2.8278E+02,  6.0573E-02
  7.1000E+03,  2.3985E+02,  4.6746E-02
  8.0000E+03,  2.0268E+02,  3.5863E-02
  9.0000E+03,  1.7102E+02,  2.7451E-02
  1.0000E+04,  1.4653E+02,  2.1518E-02
  1.1000E+04,  1.2717E+02,  1.7205E-02
  1.2000E+04,  1.1157E+02,  1.3990E-02
  1.4000E+04,  8.7941E+01,  9.6438E-03
  1.6000E+04,  7.1347E+01,  6.9504E-03
  1.8000E+04,  5.9209E+01,  5.1875E-03
  2.0000E+04,  5.0039E+01,  3.9827E-03
  3.0000E+04,  2.3062E+01,  1.4126E-03
  4.0000E+04,  1.2664E+01,  6.6707E-04
  5.0000E+04,  7.4764E+00,  3.7038E-04
  6.0000E+04,  4.4833E+00,  2.2824E-04
  7.0000E+04,  2.5857E+00,  1.5128E-04
  8.0000E+04,  1.3003E+00,  1.0581E-04
  9.0000E+04,  3.8561E-01,  7.7123E-05
  1.0000E+05,  0.0000E+00,  0.0000E+00]; %let spectrum and flux data as taken from SPENVIS short term SEU rates and LET spectra

let = spenvisdata(:,1); %let data column
intflux = spenvisdata(:,2); %integral flux data column
diffflux = spenvisdata(:,3); % differential flux data column


 % nmos2164, CMOS R160-25, Bipolar 93L422, SMJ329C50GFAM66
 Lo = [0.487 136.8 0.6 2.5353]*1000; %threshold
Cs = [1.71e-5, 1.2e-5, 2.6e-5, 5.0195e-6]; %
W = [4.95, 350, 4.4, 2.5546]*1000; %
s = [1.442, 3, 0.7, 1.3219]; %

 nmos_sigma = Cs(1) * (1-exp(-(((let-Lo(1))/W(1)).^s(1)))) .* (let > Lo(1)) * 1e-4; %nmos chip weibull to find cross section
 nmos_seu = trapz(let, nmos_sigma.*diffflux)*4*pi; %integrating with product of cross section and differential flux across let
 
 cmos_sigma = Cs(2) * (1-exp(-(((let-Lo(2))/W(2)).^s(2)))) .* (let > Lo(2)) * 1e-4; %CMOS chip weibull to find cross section
 cmos_seu = trapz(let, cmos_sigma.*diffflux)*4*pi; %integrating with product of cross section and differential flux across let
 
 bip_sigma = Cs(3) * (1-exp(-(((let-Lo(3))/W(3)).^s(3)))) .* (let > Lo(3)) * 1e-4; %Bipolar chip weibull to find cross section
 bip_seu = trapz(let, bip_sigma.*diffflux)*4*pi; %integrating with product of cross section and differential flux across let
 
 smj_sigma = Cs(4) * (1-exp(-(((let-Lo(4))/W(4)).^s(4)))) .* (let > Lo(4)) * 1e-4; %SMJ chip weibull to find cross section
 smj_seu = trapz(let, smj_sigma.*diffflux)*4*pi; %integrating with product of cross section and differential flux across let

SEU_nmos = nmos_seu
SEU_cmos = cmos_seu
SEU_biploar = bip_seu
SEU_smj = smj_seu
